GTK2=`if spell_ok gtk+2 ; then echo --with-gtk2; fi`

if  !  grep  -q  "VOUTPUT="  $SPELL_CONFIG;  then

  VOUTPUTLIST="svgalib svgalib off fb framebuffer off SDL SDL off ggi ggi off \
             gtk+ gtk+ off gtk+2 gtk+2 off default default on" &&

  VOUTPUT=`dialog --timeout ${PROMPT_DELAY} \
          --backtitle  "Video output menu"  \
	  --stdout --nocancel               \
          --radiolist "Select driver for video output"   \
          0 0 0                                    \
          $VOUTPUTLIST`
  
  if [ $? = 255 ] ; then  VOUTPUT=$GTK2 ; fi &&

  case  $VOUTPUT in
      svgalib)  VOUTPUT=--with-svgalib ;;
           fb)  VOUTPUT=--with-fb ;;
          SDL)  VOUTPUT=--with-sdl ;;
          ggi)  VOUTPUT=--with-ggi ;;
         gtk+)  VOUTPUT=--with-gtk ;;
        gtk+2)  VOUTPUT=--with-gtk2 ;;
      default)  VOUTPUT=$GTK2 ;;
  esac &&

  echo "VOUTPUT=$VOUTPUT" >> $SPELL_CONFIG
fi &&

if  !  grep  -q  "AOUTPUT="  $SPELL_CONFIG;  then

  while [ "$AOUTPUT" == "" ]; do
      unset OUTPUTLIST
      ONOFF=on
      for AUDIO_DEVICE in `ls ${INSTALL_ROOT}/dev/sound/dsp* 2>${INSTALL_ROOT}/dev/null` `ls ${INSTALL_ROOT}/dev/dsp* 2>${INSTALL_ROOT}/dev/null` default ; do
           OUTPUTLIST="$OUTPUTLIST ${AUDIO_DEVICE} ${AUDIO_DEVICE} $ONOFF"
	   if [ "$ONOFF" == on ]; then TIMEOUT=${AUDIO_DEVICE}; fi
	   ONOFF=off
      done

  AOUTPUT=`dialog --timeout ${PROMPT_DELAY} \
          --backtitle  "Audio output menu"  \
	  --stdout --nocancel               \
          --radiolist "Select device for audio output"   \
          0 0 0                                    \
          $OUTPUTLIST`

      if [ $? = 255 ] ; then  AOUTPUT=$TIMEOUT ; fi

  done

  echo "AOUTPUT=$AOUTPUT" >> $SPELL_CONFIG
fi &&

if  !  grep  -q  "USEJOYSTICK"  $SPELL_CONFIG;  then
  if    query  "Use real joystick for Kempston?" n
    then  USEJOYSTICK=y
    else  USEJOYSTICK=n
  fi
  echo  "USEJOYSTICK=$USEJOYSTICK"  >>  $SPELL_CONFIG
fi &&

echo "VOUTPUT=$VOUTPUT" >> $SPELL_CONFIG
